---
import BaseHead from "@components/BaseHead.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../config";

import data from "../data/process2.json";
import type { IMediaObj, ITweetObj, IUserObj } from "@typings/twitter";

// const url =
//   "https://hot-buns-dev.up.railway.app/api/tweets/hhhghq0/likes/media";

// const token = import.meta.env.HONO_TOKEN as string;
// const res = await fetch(url, {
//   headers: {
//     Authorization: `Bearer ${token}`,
//   },
// });

// const data = await res.json();
const tweetsfromtwitter = data as unknown as ITweetObj[];

const linkToUserOnTwitter = (username: string) =>
  `https://twitter.com/${username}`;
const linkToTweetOnTwitter = (username: string, tweetId: string) =>
  `https://twitter.com/${username}/status/${tweetId}`;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Header title={SITE_TITLE} />
    <main>
      <ul class="">
        <div class="">
          <ul
            class="px-4 rounded-xl overflow-x-auto min-w-[1000px] max-w-[1000px"
          >
            {
              tweetsfromtwitter.map((tweet) => (
                <li>
                  <a
                    href={linkToTweetOnTwitter(tweet.author.username, tweet.id)}
                  >
                    {tweet.id}
                  </a>
                  <a href={linkToUserOnTwitter(tweet.author.username)}>
                    {tweet.author.id}
                  </a>
                  <ul>
                    {tweet.media &&
                      tweet.media.map((mediaItem) => (
                        <li>
                          <details>
                            <summary>{mediaItem.type}</summary>

                            {mediaItem.type === "photo" && (
                              <div class="max-h-[200px] min-w-[200px]">
                                <img
                                  src={mediaItem.url}
                                  alt={
                                    mediaItem.alt_text ||
                                    "No alt text provided..."
                                  }
                                />
                              </div>
                            )}
                            {mediaItem.type === "video" ||
                              (mediaItem.type === "animated_gif" && (
                                <div class="max-h-[200px] min-w-[200px]">
                                  <img
                                    src={mediaItem.preview_image_url}
                                    alt={
                                      mediaItem.alt_text ||
                                      "No alt text provided..."
                                    }
                                  />
                                </div>
                              ))}
                          </details>
                        </li>
                      ))}
                  </ul>
                </li>
              ))
            }
          </ul>
        </div>

        <!-- <li>
          mouse: <a class="rounded-xl p-2 text-indigo-300" href="/"
            >secret contents</a
          >
        </li>
        <li>
          cat: <a
            class="rounded-xl p-2 text-lg text-blue-600 font-mono"
            href="/">secret contents</a
          >
        </li>
        <li>
          lizard: <a
            class="rounded-xl p-2 text-xl text-pink-700 bg-white"
            href="/">secret contents</a
          >
        </li>
        <li>
          snake: <a class="rounded-xl p-2 text-xs text-violet-200" href="/"
            >secret contents</a
          >
        </li> -->
        <!-- <details class="indent-0">
          <summary>dog</summary>
          <div class="indent-20 flex flex-col gap-4">
            <li>
              shibe: <a class="rounded-xl p-2 text-indigo-300" href="/"
                >secret contents</a
              >
            </li>
            <li>
              leone: <a class="rounded-xl p-2 text-indigo-300" href="/"
                >secret contents</a
              >
            </li>
            <details class="indent-20">
              <summary>real</summary>
              <div class="indent-40 flex flex-col gap-4">
                <li>
                  <a
                    class="rounded-xl p-2 text-xl text-pink-700 bg-white"
                    href="/">secret contents</a
                  >
                </li>
                <li>
                  bark: <a class="rounded-xl p-2 text-indigo-300" href="/"
                    >secret contents</a
                  >
                </li>
                <li>
                  barking: <a class="rounded-xl p-2 text-indigo-300" href="/"
                    >secret contents</a
                  >
                </li>
              </div>
            </details>
          </div>
        </details> -->
      </ul>
    </main>
    <Footer />
  </body>
</html>
